@model LollyASPMVC.Models.LollyViewModel
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@{
    ViewBag.Title = "Lolly";
}

@using (Html.BeginForm())
{
    <table>
        <tr>
            <td>Language:</td>
            <td>
                @Html.DropDownListFor(m => m.SelectedLangID, Model.LangList)
            </td>
            <td>Dictionary:</td>
            <td>
                @Html.DropDownListFor(m => m.SelectedDictName, Enumerable.Empty<SelectListItem>())
            </td>
        </tr>
        <tr>
            <td>Word:</td>
            <td colspan="2">
                @Html.TextBoxFor(m => m.Word)
            </td>
            <td>
                <input type="submit" value="Search" id='search' />
            </td>
        </tr>
    </table>
}
<iframe id='dictframe' width='100%' height='500'></iframe>

<script src="~/Scripts/jquery-1.10.2.min.js"></script>
<script type="text/javascript">
    var $lang = $('#SelectedLangID');
    var $dict = $('#SelectedDictName');
    $lang.change(function() {
        var langid = $(this).val();
        if (langid != null && langid != '') {
            $.getJSON('@Url.Action("DictList")', {langid: langid}, function(response) {
                $dict.empty();
                $.each(response, function(index, dict) {
                    $dict.append($('<option/>', {text: dict}));
                });
            });
        }
    });
    $lang.change();
    $('#search').click(function(e) {
        var $form = $(this).closest("form");
        e.preventDefault();
        $.post('@Url.Action("UrlByWord")', $form.serialize(), function(response) {
            $('#dictframe').attr('src', response);
        });
    });
</script>