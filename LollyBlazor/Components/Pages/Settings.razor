@page "/settings"

<div class="settings-container">
    <!-- Language -->
    <div class="form-row">
        <label for="lang">Language:</label>
        <select id="lang"
                @bind:get="vm.SelectedLang.ID"
                @bind:set="OnLangChange"
                class="select-input">
            @foreach (var o in vm.Languages)
            {
                <option value="@o.ID">@o.LANGNAME</option>
            }
        </select>
    </div>

    <!-- Voice -->
    <div class="form-row">
        <label for="voice">Voice:</label>
        <select id="voice"
                @bind:get="vm.SelectedVoice.ID"
                @bind:set="OnVoiceChange"
                class="select-input">
            @foreach (var o in vm.Voices)
            {
                <option value="@o.ID">@o.VOICENAME</option>
            }
        </select>
    </div>

    <!-- Dictionary(Reference) -->
    <div class="form-row">
        <label for="dictReference">Dictionary(Reference):</label>
        <select id="dictReference"
                @bind:get="vm.SelectedDictReference.ID"
                @bind:set="OnDictReferenceChange"
                class="select-input">
            @foreach (var o in vm.DictsReference)
            {
                <option value="@o.ID">@o.DICTNAME</option>
            }
        </select>
    </div>

    <!-- Dictionary(Note) -->
    <div class="form-row">
        <label for="dictNote">Dictionary(Note):</label>
        <select id="dictNote"
                @bind:get="vm.SelectedDictNote.ID"
                @bind:set="OnDictNoteChange"
                class="select-input">
            @foreach (var o in vm.DictsNote)
            {
                <option value="@o.ID">@o.DICTNAME</option>
            }
        </select>
    </div>

    <!-- Dictionary(Translation) -->
    <div class="form-row">
        <label for="dictTranslation">Dictionary(Translation):</label>
        <select id="dictTranslation"
                @bind:get="vm.SelectedDictTranslation.ID"
                @bind:set="OnDictTranslationChange"
                class="select-input">
            @foreach (var o in vm.DictsTranslation)
            {
                <option value="@o.ID">@o.DICTNAME</option>
            }
        </select>
    </div>

    <!-- Textbook -->
    <div class="form-row">
        <label for="textbook">Textbook:</label>
        <select id="textbook"
                @bind:get="vm.SelectedTextbook.ID"
                @bind:set="OnTextbookChange"
                class="select-input">
            @foreach (var o in vm.Textbooks)
            {
                <option value="@o.ID">@o.TEXTBOOKNAME</option>
            }
        </select>
    </div>

    <!-- Unit From -->
    <div class="form-row">
        <label for="unitFrom">Unit:</label>
        <select id="unitFrom"
                @bind="vm.USUNITFROM"
                @bind:after="OnUnitFromChange"
                class="select-input">
            @foreach (var o in vm.Units)
            {
                <option value="@o.Value">@o.Label</option>
            }
        </select>
        <select id="partFrom"
                disabled="@ToTypeIsUnit"
                @bind="vm.USPARTFROM"
                @bind:after="OnPartFromChange"
                class="select-input">
            @foreach (var o in vm.Parts)
            {
                <option value="@o.Value">@o.Label</option>
            }
        </select>
    </div>

    <!-- To Type + Unit/Part To -->
    <div class="form-row">
        <select id="toType"
                @bind:get="ToType"
                @bind:set="OnToTypeChange"
                class="select-short">
            @foreach (var o in SettingsViewModel.ToTypes)
            {
                <option value="@o.Value">@o.Label</option>
            }
        </select>
        <select id="unitTo"
                disabled="@(!ToTypeIsTo)"
                @bind="vm.USUNITTO"
                @bind:after="OnUnitToChange"
                class="select-input">
            @foreach (var o in vm.Units)
            {
                <option value="@o.Value">@o.Label</option>
            }
        </select>
        <select id="partTo"
                disabled="@(!ToTypeIsTo)"
                @bind="vm.USPARTTO"
                @bind:after="OnPartToChange"
                class="select-input">
            @foreach (var o in vm.Parts)
            {
                <option value="@o.Value">@o.Label</option>
            }
        </select>
    </div>

    <!-- Previous / Next Buttons -->
    <div class="form-row">
        <div class="label-spacer"></div>
        <div class="button-group">
            <button class="btn-primary"
                    disabled="@ToTypeIsTo"
                    @onclick="PreviousUnitPart">
                Previous
            </button>
            <button class="btn-primary"
                    disabled="@ToTypeIsTo"
                    @onclick="NextUnitPart">
                Next
            </button>
        </div>
    </div>
</div>


@code {
  SettingsViewModel vm = App.vmSettings;

  bool ToTypeIsUnit => vm.ToType == UnitPartToType.Unit;
  bool ToTypeIsTo => vm.ToType == UnitPartToType.To;
  int ToType => (int)vm.ToType;

  void OnLangChange(int id)
  {
      vm.SelectedLang = vm.Languages.First(o => o.ID == id);
  }
  void OnVoiceChange(int id)
  {
      vm.SelectedVoice = vm.Voices.First(o => o.ID == id);
  }
  void OnDictReferenceChange(int id)
  {
      vm.SelectedDictReference = vm.DictsReference.First(o => o.ID == id);
  }
  void OnDictNoteChange(int id)
  {
      vm.SelectedDictNote = vm.DictsNote.First(o => o.ID == id);
  }
  void OnDictTranslationChange(int id)
  {
      vm.SelectedDictTranslation = vm.DictsTranslation.First(o => o.ID == id);
  }
  void OnTextbookChange(int id)
  {
      vm.SelectedTextbook = vm.Textbooks.First(o => o.ID == id);
  }
  void OnUnitFromChange()
  {
      
  }
  void OnPartFromChange()
  {
      
  }
  void OnToTypeChange(int value)
  {
      vm.ToType = (UnitPartToType)value;
  }
  void OnUnitToChange()
  {
      
  }
  void OnPartToChange()
  {
      
  }
  async Task PreviousUnitPart()
  {
      await vm.PreviousUnitPart();
  }
  async Task NextUnitPart()
  {
      await vm.NextUnitPart();
  }
}
